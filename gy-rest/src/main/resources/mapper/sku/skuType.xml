<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><!-- 参数管理手工映射SQL语句 -->
<!-- 参数管理手工映射SQL语句 -->
<mapper namespace="skuType">

    <sql id="sql_where">
        where
        a.is_delete = 'N'
        <if test="null!=_id  and ''!= _id">
            and a.id = #{_id}
        </if>
        <if test="null!=food_add_type  and ''!= food_add_type">
            and a.food_add_type LIKE concat('%',#{food_add_type},'%')
        </if>
        <if test="null!=text  and ''!= text">
            and a.text LIKE concat('%',#{text},'%')
        </if>
        <if test="null!=number  and ''!= number">
            and a.number LIKE concat('%',#{number},'%')
        </if>
        <if test="null!=sortno  and ''!= sortno">
            and a.sortno = #{sortno}
        </if>
    </sql>

    <!-- 插入 -->
    <insert id="saveInfo" parameterType="map">
        INSERT INTO
        w_sku_type (

        <if test="null!=text  and ''!= text">
            text ,
        </if>
        <if test="null!=sortno  and ''!= sortno">
            sortno ,
        </if>
        <if test="null!=food_add_type  and ''!= food_add_type">
            food_add_type ,
        </if>
        <if test="null!=number  and ''!= number">
            number ,
        </if>
        create_time,
        creator,
        update_time,
        updator,
        status
        ) VALUES(

        <if test="null!=text  and ''!= text">
            #{text} ,
        </if>
        <if test="null!=sortno  and ''!= sortno">
            #{sortno} ,
        </if>
        <if test="null!=food_add_type  and ''!= food_add_type">
            #{food_add_type} ,
        </if>
        <if test="null!=number  and ''!= number">
            #{number} ,
        </if>
        now(),
        #{creator},
        now(),
        #{updator},
        0
        );
        <selectKey resultType="java.lang.String" keyProperty="id">
            SELECT LAST_INSERT_ID() as id
        </selectKey>
    </insert>

    <!-- 删除 -->
    <delete id="deleteInfo" parameterType="map">
        UPDATE w_sku_type set is_delete = 'Y' WHERE id = #{id}
    </delete>

    <!-- 商品类别>>商品列表 -->
    <select id="querySkuList" parameterType="map" resultType="dto">
        SELECT
        id as sku_id,
        name as sku_name,
        typed,
        level
        FROM
        w_sku_type
        WHERE
        type_id = #{type_id}
        and status = 0
        and is_delete = 'N'
    </select>

    <!-- 对象查询 -->
    <select id="getInfo" parameterType="map" resultType="dto">
        SELECT
        *
        FROM
        w_sku_type
        WHERE
        id = #{id}
        and status = 0
        and is_delete = 'N'
    </select>


    <!-- 列表查询 -->
    <select id="queryList" parameterType="map" resultType="dto">
        SELECT
        a.*
        FROM
        w_sku_type a
        <include refid="sql_where"/>
        order by a.id DESC
        <if test="null!=start">
            limit #{start},#{end}
        </if>
    </select>

    <!-- 列表数量查询 -->
    <select id="queryListCount" parameterType="map" resultType="dto">
        SELECT
        count(1) as total
        FROM
        w_sku_type a
        <include refid="sql_where"/>
    </select>

    <!-- 下拉商品列表查询 -->
    <select id="queryBoxList" parameterType="map" resultType="dto">
        SELECT
        a.id,
        a.name
        FROM
        w_sku_type a
        WHERE a.is_delete = 'N'
        order by a.create_time
    </select>

    <!-- 修改 -->
    <update id="updateInfo" parameterType="map">
        UPDATE w_sku_type a
        set

        <if test="null!=food_add_type  and ''!= food_add_type">
            a.food_add_type = #{food_add_type} ,
        </if>
        <if test="null!=number  and ''!= number">
            a.number = #{number} ,
        </if>
        <if test="null!=text  and ''!= text">
            a.text = #{text} ,
        </if>
        <if test="null!=sortno  and ''!= sortno">
            a.sortno = #{sortno} ,
        </if>
        update_time = now(),
        a.updator = #{updator}
        where
        a.id = #{id}
    </update>


    <!-- 对象查询 -->
    <select id="getSkuTypeInfo" parameterType="map" resultType="dto">
        SELECT
        *
        FROM
        w_sku_type
        WHERE
        status = 0
        and is_delete = 'N'
        <if test="null!=number  and ''!= number">
            and number = #{number}
        </if>
        <if test="null!=text  and ''!= text">
            and text = #{text}
        </if>
        limit 1
    </select>
</mapper>
