<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><!-- 参数管理手工映射SQL语句 -->

<!-- 参数管理手工映射SQL语句 -->
<!-- 仓库表信息 -->
<mapper namespace="warehouse">

    <sql id="sql_where">
        <if test="null!=id  and ''!= id">
            and a.id = #{id}
        </if>
        <if test="null!=name  and ''!= name">
            and a.name LIKE concat('%',#{name},'%')
        </if>
        <if test="null!=number  and ''!= number">
            and a.number LIKE concat('%',#{number},'%')
        </if>
        <if test="null!=charge_mobile  and ''!= charge_mobile">
            and a.charge_mobile LIKE concat('%',#{charge_mobile},'%')
        </if>
        <if test="null!=attribute  and ''!= attribute">
            and a.attribute = #{attribute}
        </if>
        <if test="null!=deptid  and ''!= deptid">
            and a.deptid = #{deptid}
        </if>
        <if test="null!=address  and ''!= address">
            and a.address LIKE concat('%',#{address},'%')
        </if>
        <if test="null!=longitude  and ''!= longitude">
            and a.longitude = #{longitude}
        </if>
        <if test="null!=dimension  and ''!= dimension">
            and a.dimension = #{dimension}
        </if>
        <if test="null!=charge_person  and ''!= charge_person">
            and a.charge_person LIKE concat('%',#{charge_person},'%')
        </if>
        <if test="null!=startTime  and ''!= startTime">
            and DATE(a.create_time) &gt;= #{startTime}
        </if>
        <if test="null!=endTime  and ''!= endTime">
            and DATE(a.create_time) &lt;= #{endTime}
        </if>
    </sql>

    <!-- 插入 -->
    <insert id="saveInfo" parameterType="map">
        INSERT INTO
        w_warehouse (

        <if test="null!=number  and ''!= number">
            number ,
        </if>
        <if test="null!=name  and ''!= name">
            name ,
        </if>
        <if test="null!=type">
            type ,
        </if>
        <if test="null!=deptid  and ''!= deptid">
            deptid ,
        </if>
        <if test="null!=attribute  and ''!= attribute">
            attribute ,
        </if>
        <if test="null!=square  and ''!= square">
            square ,
        </if>
        <if test="null!=height  and ''!= height">
            height ,
        </if>
        <if test="null!=province  and ''!= province">
            province ,
        </if>
        <if test="null!=city  and ''!= city">
            city ,
        </if>
        <if test="null!=country  and ''!= country">
            country ,
        </if>
        <if test="null!=address  and ''!= address">
            address ,
        </if>
        <if test="null!=charge_person  and ''!= charge_person">
            charge_person ,
        </if>
        <if test="null!=charge_mobile  and ''!= charge_mobile">
            charge_mobile ,
        </if>
        <if test="null!=email  and ''!= email">
            email ,
        </if>
        <if test="null!=zip_code  and ''!= zip_code">
            zip_code ,
        </if>
        <if test="null!=status">
            status ,
        </if>
        <if test="null!=remark  and ''!= remark">
            remark ,
        </if>
        <if test="null!=longitude  and ''!= longitude">
            longitude ,
        </if>
        <if test="null!=dimension  and ''!= dimension">
            dimension ,
        </if>
        create_time,
        creator,
        update_time,
        updator
        ) VALUES(

        <if test="null!=number  and ''!= number">
            #{number} ,
        </if>
        <if test="null!=name  and ''!= name">
            #{name} ,
        </if>
        <if test="null!=type">
            #{type} ,
        </if>
        <if test="null!=deptid  and ''!= deptid">
            #{deptid} ,
        </if>
        <if test="null!=attribute  and ''!= attribute">
            #{attribute} ,
        </if>
        <if test="null!=square  and ''!= square">
            #{square} ,
        </if>
        <if test="null!=height  and ''!= height">
            #{height} ,
        </if>
        <if test="null!=province  and ''!= province">
            #{province} ,
        </if>
        <if test="null!=city  and ''!= city">
            #{city} ,
        </if>
        <if test="null!=country  and ''!= country">
            #{country} ,
        </if>
        <if test="null!=address  and ''!= address">
            #{address} ,
        </if>
        <if test="null!=charge_person  and ''!= charge_person">
            #{charge_person} ,
        </if>
        <if test="null!=charge_mobile  and ''!= charge_mobile">
            #{charge_mobile} ,
        </if>
        <if test="null!=email  and ''!= email">
            #{email} ,
        </if>
        <if test="null!=zip_code  and ''!= zip_code">
            #{zip_code} ,
        </if>
        <if test="null!=status">
            #{status} ,
        </if>
        <if test="null!=remark  and ''!= remark">
            #{remark} ,
        </if>
        <if test="null!=longitude  and ''!= longitude">
            #{longitude} ,
        </if>
        <if test="null!=dimension  and ''!= dimension">
            #{dimension} ,
        </if>
        now(),
        #{creator},
        now(),
        #{updator}
        );
        <selectKey resultType="java.lang.String" keyProperty="id">
            SELECT LAST_INSERT_ID() as id
        </selectKey>
    </insert>

    <!-- 删除 -->
    <update id="deleteInfo" parameterType="map">
        UPDATE w_warehouse set is_delete = 'Y' where id = #{id}
    </update>

    <!-- 修改 -->
    <update id="updateInfo" parameterType="map">
        UPDATE w_warehouse a
        set

        <if test="null!=number  and ''!= number">
            a.number = #{number} ,
        </if>
        <if test="null!=name  and ''!= name">
            a.name = #{name} ,
        </if>
        <if test="null!=type">
            a.type = #{type} ,
        </if>
        <if test="null!=deptid  and ''!= deptid">
            a.deptid = #{deptid} ,
        </if>
        <if test="null!=attribute  and ''!= attribute">
            a.attribute = #{attribute} ,
        </if>
        <if test="null!=square  and ''!= square">
            a.square = #{square} ,
        </if>
        <if test="null!=height  and ''!= height">
            a.height = #{height} ,
        </if>
        <if test="null!=province  and ''!= province">
            a.province = #{province} ,
        </if>
        <if test="null!=city  and ''!= city">
            a.city = #{city} ,
        </if>
        <if test="null!=country  and ''!= country">
            a.country = #{country} ,
        </if>
        <if test="null!=address  and ''!= address">
            a.address = #{address} ,
        </if>
        <if test="null!=charge_person  and ''!= charge_person">
            a.charge_person = #{charge_person} ,
        </if>
        <if test="null!=charge_mobile  and ''!= charge_mobile">
            a.charge_mobile = #{charge_mobile} ,
        </if>
        <if test="null!=email  and ''!= email">
            a.email = #{email} ,
        </if>
        <if test="null!=zip_code  and ''!= zip_code">
            a.zip_code = #{zip_code} ,
        </if>
        <if test="null!=status">
            a.status = #{status} ,
        </if>
        <if test="null!=remark  and ''!= remark">
            a.remark = #{remark} ,
        </if>
        <if test="null!=create_time  and ''!= create_time">
            a.create_time = #{create_time} ,
        </if>
        <if test="null!=creator  and ''!= creator">
            a.creator = #{creator} ,
        </if>
        <if test="null!=is_delete  and ''!= is_delete">
            a.is_delete = #{is_delete} ,
        </if>
        <if test="null!=longitude  and ''!= longitude">
            a.longitude = #{longitude} ,
        </if>
        <if test="null!=dimension  and ''!= dimension">
            a.dimension = #{dimension} ,
        </if>
        update_time = now(),
        a.updator = #{updator}
        where
        a.id = #{id}
    </update>

    <!-- 列表查询 -->
    <select id="queryList" parameterType="map" resultType="dto">
        SELECT
        a.id,
        a.number,
        a.name,
        sc.val as type,
        sd.dept_name as dept_name,
        a.deptid,
        a.attribute,
        a.square,
        a.height,
        a.province,
        a.city,
        a.country,
        a.address,
        a.charge_person,
        a.charge_mobile,
        a.email,
        a.zip_code,

        a.remark,
        a.create_time,a.dimension,a.longitude
        FROM
        w_warehouse a
        left join sys_config sc on sc.id = a.type
        left join sys_config sc2 on sc2.id = a.status
        left join sys_dept sd on sd.id = a.deptid
        WHERE 1 = 1 AND a.is_delete = 'N'
        <include refid="sql_where"/>
        ORDER BY id desc
        <if test="null!=start">
            limit ${start},${end}
        </if>
    </select>

    <!-- 下拉框列表查询 -->
    <select id="queryBoxList" parameterType="map" resultType="dto">
        SELECT
        a.id,
        a.name
        FROM
        w_warehouse a
        <include refid="sql_where"/>
        <if test="null!=start">
            limit #{start},#{end}
        </if>
    </select>

    <!-- 列表数量查询 -->
    <select id="queryListCount" parameterType="map" resultType="dto">
        SELECT count(1) as total
        FROM w_warehouse a
        WHERE 1 = 1 AND a.is_delete = 'N'
        <include refid="sql_where"/>
        ORDER BY id
    </select>

    <!-- 对象查询 -->
    <select id="getInfo" parameterType="map" resultType="dto">
        SELECT a.*
        FROM w_warehouse a
        left join sys_config sc on sc.id = a.type
        left join sys_config sc2 on sc2.id = a.status
        left join sys_dept sd on sd.id = a.deptid
        WHERE 1 = 1 AND a.is_delete = 'N'
        <include refid="sql_where"/>
    </select>
</mapper>
