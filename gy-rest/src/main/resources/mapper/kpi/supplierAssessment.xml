<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><!-- 参数管理手工映射SQL语句 -->
<!-- 参数管理手工映射SQL语句 -->
<mapper namespace="supplierAssessment">

    <!-- 列表查询 -->
    <select id="queryList" parameterType="map" resultType="dto">
        SELECT
        provider. NAME,
        config.val AS type,
        activity.activity_no,
        tms_provide.adate,
        tms_provide.delay_days
        FROM
        oms_assessment_sku_provider tms_provide
        LEFT JOIN oms_cmn_provider provider ON provider.id = tms_provide.provider_id
        LEFT JOIN oms_fee_activity fee_activity ON fee_activity.id = tms_provide.activity_id
        LEFT JOIN sys_config config ON config.id = fee_activity.activity_type
        LEFT JOIN wms_activity activity ON activity.id = tms_provide.activity_id
        <if test="null!=type_id  and ''!= type_id">
            and fee_activity.activity_type = #{type_id}
        </if>
        <if test="null!=_begin_time">
            and tms_provide.adate BETWEEN ''
        </if>
        <if test="null!=_begin_time  and ''!= _begin_time">
            and tms_provide.adate BETWEEN #{_begin_time}
        </if>
        <if test="null!=_end_time">
            and now()
        </if>
        <if test="null!=_end_time  and ''!= _end_time">
            and #{_end_time}
        </if>
        and tms_provide.is_delete = 'N'
    </select>
</mapper>
