<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><!-- 参数管理手工映射SQL语句 -->
<!-- 参数管理手工映射SQL语句 -->
<mapper namespace="recipient">


    <sql id="sql_where">
        <if test="null!=recipient_store  and ''!= recipient_store">
            and a.recipient_store like Concat ('%',#{recipient_store},'%')
        </if>
        <if test="null!=recipient_store_address  and ''!= recipient_store_address">
            and a.recipient_store_address like Concat ('%',#{recipient_store_address},'%')
        </if>
        <if test="null!=recipient_people  and ''!= recipient_people">
            and a.recipient_people like Concat ('%',#{recipient_people},'%')
        </if>
        <if test="null!=recipient_people_mobile  and ''!= recipient_people_mobile">
            and a.recipient_people_mobile like Concat ('%',#{recipient_people_mobile},'%')
        </if>
        <if test="null!=id  and ''!= id">
            and a.id = #{id}
        </if>
    </sql>

    <!-- 插入 -->
    <insert id="saveInfo" parameterType="dto">
        INSERT INTO w_recipient_info (


        <if test="null!=recipient_store  and ''!= recipient_store">recipient_store ,</if>
        <if test="null!=recipient_store_address  and ''!= recipient_store_address">recipient_store_address ,</if>
        <if test="null!=recipient_people  and ''!= recipient_people">recipient_people ,</if>
        <if test="null!=recipient_people_mobile  and ''!= recipient_people_mobile">recipient_people_mobile ,</if>

        create_time
        )
        VALUES
        (


        <if test="null!=recipient_store  and ''!= recipient_store">#{recipient_store} ,</if>
        <if test="null!=recipient_store_address  and ''!= recipient_store_address">#{recipient_store_address} ,</if>
        <if test="null!=recipient_people  and ''!= recipient_people">#{recipient_people} ,</if>
        <if test="null!=recipient_people_mobile  and ''!= recipient_people_mobile">#{recipient_people_mobile} ,</if>

        now()
        )
        <selectKey resultType="java.lang.Long" keyProperty="id">
            SELECT LAST_INSERT_ID() as id
        </selectKey>
    </insert>

    <!-- 删除 -->
    <update id="deleteInfo" parameterType="dto">
        update w_recipient_info a
        set a.is_delete = 'Y'
        where a.id=#{id}
    </update>

    <!-- 修改 -->
    <update id="updateInfo" parameterType="dto">
        update w_recipient_info SET
        <if test="null!=recipient_store  and ''!= recipient_store">recipient_store = #{recipient_store} ,</if>
        <if test="null!=recipient_store_address  and ''!= recipient_store_address">recipient_store_address=
            #{recipient_store_address} ,
        </if>
        <if test="null!=recipient_people  and ''!= recipient_people">recipient_people = #{recipient_people} ,</if>
        <if test="null!=recipient_people_mobile  and ''!= recipient_people_mobile">recipient_people_mobile =
            #{recipient_people_mobile} ,
        </if>
        <if test="null!=updator  and ''!= updator">updator = #{updator} ,</if>
        update_time = now()
        where id=#{id}
    </update>

    <!-- 列表查询 -->
    <select id="queryList" parameterType="map" resultType="dto">
        SELECT a.*,a.recipient_store as value,a.id as recipient_id
        FROM
        w_recipient_info a
        WHERE 1 = 1 AND a.is_delete = 'N'
        <include refid="sql_where"/>
    </select>

    <!-- 对象查询 -->
    <select id="getInfo" parameterType="map" resultType="dto">
        SELECT a.*
        FROM w_recipient_info a
        WHERE 1 = 1 AND a.is_delete = 'N'
        <if test="null!=id  and ''!= id">and a.id = #{id}</if>

        limit 0,1
    </select>

    <!-- 对象查询 -->
    <select id="getInfoByRecipientStore" parameterType="map" resultType="dto">
        SELECT a.*
        FROM w_recipient_info a
        WHERE 1 = 1 AND a.is_delete = 'N'
        <if test="null!=recipient_store  and ''!= recipient_store">and a.recipient_store = #{recipient_store}</if>
        limit 0,1
    </select>

    <!-- 列表数量查询 -->
    <select id="queryListCount" parameterType="map" resultType="dto">
        select
        count(1) as total
        FROM w_recipient_info a
        WHERE 1 = 1 AND a.is_delete = 'N'
    </select>


</mapper>
