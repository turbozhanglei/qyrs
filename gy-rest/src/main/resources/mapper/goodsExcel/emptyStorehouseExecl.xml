<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><!-- 参数管理手工映射SQL语句 -->
<!-- 参数管理手工映射SQL语句 -->
<mapper namespace="emptyStorehouseExecl">


    <!-- 列表查询 -->
    <select id="queryList" parameterType="map" resultType="dto">
        SELECT
        a.*, w. NAME AS wname,
        wa. NAME AS waname
        FROM
        w_warehouse_site_setting a
        LEFT JOIN w_tray t ON t.savelocation = a.id
        LEFT JOIN w_warehouse w ON w.id = a.warehouse_id
        LEFT JOIN w_warehouse_area wa ON wa.id = a.warehouse_area_id
        WHERE
        t.savelocation IS NULL
        <if test="null!=number  and ''!= number">
            and a.number like Concat ('%',#{number},'%')
        </if>
        <if test="null!=name  and ''!= name">
            and a.name like Concat ('%',#{name},'%')
        </if>
        <if test="null!=start">
            limit ${start},${end}
        </if>
    </select>
    <!-- 查询 -->
    <select id="queryListCount" parameterType="map" resultType="dto">
        SELECT
        count(1) AS total
        FROM
        (
        SELECT
        a.*, w. NAME AS wname,
        wa. NAME AS waname
        FROM
        w_warehouse_site_setting a
        LEFT JOIN w_tray t ON t.savelocation = a.id
        LEFT JOIN w_warehouse w ON w.id = a.warehouse_id
        LEFT JOIN w_warehouse_area wa ON wa.id = a.warehouse_area_id
        WHERE
        t.savelocation IS NULL
        <if test="null!=number  and ''!= number">
            and a.number like Concat ('%',#{number},'%')
        </if>
        <if test="null!=name  and ''!= name">
            and a.name like Concat ('%',#{name},'%')
        </if>
        ) AS a
    </select>

</mapper>
